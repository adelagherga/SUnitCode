// RecursiveSets.m

/*
INPUT:
    S:= [2,p_1,...,p_{i-1}], a list of primes such that 2*p_1*...*p_{i-1} <= m
    nSets:= [S_1,...,S_{k-1}], where 
        S_j:= [2,p_1,...,p_{n_j}] is a list of primes such that 2*p_1*...*p_{n_j} <= m
    i:= index of the set S of prime to be added
    n:= the number of elements of the largest possible set S_j, where
        S_j:= [2,p_1,...,p_{n-1}] and 2*p_1*...*p_{n-1} <= m
    m:= upper bound on the product of the primes of each set S_j of nSets

OUTPUT:
    S:= [2,p_1,...,p_{i-1}, p_i], a list of primes such that 2*p_1*...*p_i <= m
    nSets:= [S_1,...,S_{k-1}, S_k], where 
        S_i:= [2,p_1,...,p_{n_i}] is a list of primes such that 
            2*p_1*...*p_{n_i} <= m and S_i is not a subset of any other set S_j of nSets

COMMENTS:
    This is a recursive algorithm. The procedure re-enters itself until i > n, when the output is finally generated.  

EXAMPLE:
    > S:= [2,3,5,11];
    > nSets:= [];
    > i:= 5;
    > n:= 7;
    > m:= 10^6;
    > RecursiveSets(~S,~nSets,i,n,m);
    > nSets;
    [
        [ 2, 3, 5, 11, 13, 17 ],
        [ 2, 3, 5, 11, 13, 19 ],
        [ 2, 3, 5, 11, 13, 23 ],
        [ 2, 3, 5, 11, 13, 29 ],
        [ 2, 3, 5, 11, 13, 31 ],
        [ 2, 3, 5, 11, 13, 37 ],
        [ 2, 3, 5, 11, 13, 41 ],
        [ 2, 3, 5, 11, 13, 43 ],
        [ 2, 3, 5, 11, 13, 47 ],
        [ 2, 3, 5, 11, 13, 53 ],
        [ 2, 3, 5, 11, 13, 59 ],
        [ 2, 3, 5, 11, 13, 61 ],
        [ 2, 3, 5, 11, 13, 67 ],
        [ 2, 3, 5, 11, 13, 71 ],
        [ 2, 3, 5, 11, 13, 73 ],
        [ 2, 3, 5, 11, 13, 79 ],
        [ 2, 3, 5, 11, 13, 83 ],
        [ 2, 3, 5, 11, 13, 89 ],
        [ 2, 3, 5, 11, 13, 97 ],
        [ 2, 3, 5, 11, 13, 101 ],
        [ 2, 3, 5, 11, 13, 103 ],
        [ 2, 3, 5, 11, 13, 107 ],
        [ 2, 3, 5, 11, 13, 109 ],
        [ 2, 3, 5, 11, 13, 113 ],
        [ 2, 3, 5, 11, 13, 127 ],
        [ 2, 3, 5, 11, 13, 131 ],
        [ 2, 3, 5, 11, 13, 137 ],
        [ 2, 3, 5, 11, 13, 139 ],
        [ 2, 3, 5, 11, 13, 149 ],
        [ 2, 3, 5, 11, 13, 151 ],
        [ 2, 3, 5, 11, 13, 157 ],
        [ 2, 3, 5, 11, 13, 163 ],
        [ 2, 3, 5, 11, 13, 167 ],
        [ 2, 3, 5, 11, 13, 173 ],
        [ 2, 3, 5, 11, 13, 179 ],
        [ 2, 3, 5, 11, 13, 181 ],
        [ 2, 3, 5, 11, 13, 191 ],
        [ 2, 3, 5, 11, 13, 193 ],
        [ 2, 3, 5, 11, 13, 197 ],
        [ 2, 3, 5, 11, 13, 199 ],
        [ 2, 3, 5, 11, 13, 211 ],
        [ 2, 3, 5, 11, 13, 223 ],
        [ 2, 3, 5, 11, 13, 227 ],
        [ 2, 3, 5, 11, 13, 229 ],
        [ 2, 3, 5, 11, 13, 233 ],
        [ 2, 3, 5, 11, 17, 19 ],
        [ 2, 3, 5, 11, 17, 23 ],
        [ 2, 3, 5, 11, 17, 29 ],
        [ 2, 3, 5, 11, 17, 31 ],
        [ 2, 3, 5, 11, 17, 37 ],
        [ 2, 3, 5, 11, 17, 41 ],
        [ 2, 3, 5, 11, 17, 43 ],
        [ 2, 3, 5, 11, 17, 47 ],
        [ 2, 3, 5, 11, 17, 53 ],
        [ 2, 3, 5, 11, 17, 59 ],
        [ 2, 3, 5, 11, 17, 61 ],
        [ 2, 3, 5, 11, 17, 67 ],
        [ 2, 3, 5, 11, 17, 71 ],
        [ 2, 3, 5, 11, 17, 73 ],
        [ 2, 3, 5, 11, 17, 79 ],
        [ 2, 3, 5, 11, 17, 83 ],
        [ 2, 3, 5, 11, 17, 89 ],
        [ 2, 3, 5, 11, 17, 97 ],
        [ 2, 3, 5, 11, 17, 101 ],
        [ 2, 3, 5, 11, 17, 103 ],
        [ 2, 3, 5, 11, 17, 107 ],
        [ 2, 3, 5, 11, 17, 109 ],
        [ 2, 3, 5, 11, 17, 113 ],
        [ 2, 3, 5, 11, 17, 127 ],
        [ 2, 3, 5, 11, 17, 131 ],
        [ 2, 3, 5, 11, 17, 137 ],
        [ 2, 3, 5, 11, 17, 139 ],
        [ 2, 3, 5, 11, 17, 149 ],
        [ 2, 3, 5, 11, 17, 151 ],
        [ 2, 3, 5, 11, 17, 157 ],
        [ 2, 3, 5, 11, 17, 163 ],
        [ 2, 3, 5, 11, 17, 167 ],
        [ 2, 3, 5, 11, 17, 173 ],
        [ 2, 3, 5, 11, 19, 23 ],
        [ 2, 3, 5, 11, 19, 29 ],
        [ 2, 3, 5, 11, 19, 31 ],
        [ 2, 3, 5, 11, 19, 37 ],
        [ 2, 3, 5, 11, 19, 41 ],
        [ 2, 3, 5, 11, 19, 43 ],
        [ 2, 3, 5, 11, 19, 47 ],
        [ 2, 3, 5, 11, 19, 53 ],
        [ 2, 3, 5, 11, 19, 59 ],
        [ 2, 3, 5, 11, 19, 61 ],
        [ 2, 3, 5, 11, 19, 67 ],
        [ 2, 3, 5, 11, 19, 71 ],
        [ 2, 3, 5, 11, 19, 73 ],
        [ 2, 3, 5, 11, 19, 79 ],
        [ 2, 3, 5, 11, 19, 83 ],
        [ 2, 3, 5, 11, 19, 89 ],
        [ 2, 3, 5, 11, 19, 97 ],
        [ 2, 3, 5, 11, 19, 101 ],
        [ 2, 3, 5, 11, 19, 103 ],
        [ 2, 3, 5, 11, 19, 107 ],
        [ 2, 3, 5, 11, 19, 109 ],
        [ 2, 3, 5, 11, 19, 113 ],
        [ 2, 3, 5, 11, 19, 127 ],
        [ 2, 3, 5, 11, 19, 131 ],
        [ 2, 3, 5, 11, 19, 137 ],
        [ 2, 3, 5, 11, 19, 139 ],
        [ 2, 3, 5, 11, 19, 149 ],
        [ 2, 3, 5, 11, 19, 151 ],
        [ 2, 3, 5, 11, 19, 157 ],
        [ 2, 3, 5, 11, 23, 29 ],
        [ 2, 3, 5, 11, 23, 31 ],
        [ 2, 3, 5, 11, 23, 37 ],
        [ 2, 3, 5, 11, 23, 41 ],
        [ 2, 3, 5, 11, 23, 43 ],
        [ 2, 3, 5, 11, 23, 47 ],
        [ 2, 3, 5, 11, 23, 53 ],
        [ 2, 3, 5, 11, 23, 59 ],
        [ 2, 3, 5, 11, 23, 61 ],
        [ 2, 3, 5, 11, 23, 67 ],
        [ 2, 3, 5, 11, 23, 71 ],
        [ 2, 3, 5, 11, 23, 73 ],
        [ 2, 3, 5, 11, 23, 79 ],
        [ 2, 3, 5, 11, 23, 83 ],
        [ 2, 3, 5, 11, 23, 89 ],
        [ 2, 3, 5, 11, 23, 97 ],
        [ 2, 3, 5, 11, 23, 101 ],
        [ 2, 3, 5, 11, 23, 103 ],
        [ 2, 3, 5, 11, 23, 107 ],
        [ 2, 3, 5, 11, 23, 109 ],
        [ 2, 3, 5, 11, 23, 113 ],
        [ 2, 3, 5, 11, 23, 127 ],
        [ 2, 3, 5, 11, 23, 131 ],
        [ 2, 3, 5, 11, 29, 31 ],
        [ 2, 3, 5, 11, 29, 37 ],
        [ 2, 3, 5, 11, 29, 41 ],
        [ 2, 3, 5, 11, 29, 43 ],
        [ 2, 3, 5, 11, 29, 47 ],
        [ 2, 3, 5, 11, 29, 53 ],
        [ 2, 3, 5, 11, 29, 59 ],
        [ 2, 3, 5, 11, 29, 61 ],
        [ 2, 3, 5, 11, 29, 67 ],
        [ 2, 3, 5, 11, 29, 71 ],
        [ 2, 3, 5, 11, 29, 73 ],
        [ 2, 3, 5, 11, 29, 79 ],
        [ 2, 3, 5, 11, 29, 83 ],
        [ 2, 3, 5, 11, 29, 89 ],
        [ 2, 3, 5, 11, 29, 97 ],
        [ 2, 3, 5, 11, 29, 101 ],
        [ 2, 3, 5, 11, 29, 103 ],
        [ 2, 3, 5, 11, 31, 37 ],
        [ 2, 3, 5, 11, 31, 41 ],
        [ 2, 3, 5, 11, 31, 43 ],
        [ 2, 3, 5, 11, 31, 47 ],
        [ 2, 3, 5, 11, 31, 53 ],
        [ 2, 3, 5, 11, 31, 59 ],
        [ 2, 3, 5, 11, 31, 61 ],
        [ 2, 3, 5, 11, 31, 67 ],
        [ 2, 3, 5, 11, 31, 71 ],
        [ 2, 3, 5, 11, 31, 73 ],
        [ 2, 3, 5, 11, 31, 79 ],
        [ 2, 3, 5, 11, 31, 83 ],
        [ 2, 3, 5, 11, 31, 89 ],
        [ 2, 3, 5, 11, 31, 97 ],
        [ 2, 3, 5, 11, 37, 41 ],
        [ 2, 3, 5, 11, 37, 43 ],
        [ 2, 3, 5, 11, 37, 47 ],
        [ 2, 3, 5, 11, 37, 53 ],
        [ 2, 3, 5, 11, 37, 59 ],
        [ 2, 3, 5, 11, 37, 61 ],
        [ 2, 3, 5, 11, 37, 67 ],
        [ 2, 3, 5, 11, 37, 71 ],
        [ 2, 3, 5, 11, 37, 73 ],
        [ 2, 3, 5, 11, 37, 79 ],
        [ 2, 3, 5, 11, 41, 43 ],
        [ 2, 3, 5, 11, 41, 47 ],
        [ 2, 3, 5, 11, 41, 53 ],
        [ 2, 3, 5, 11, 41, 59 ],
        [ 2, 3, 5, 11, 41, 61 ],
        [ 2, 3, 5, 11, 41, 67 ],
        [ 2, 3, 5, 11, 41, 71 ],
        [ 2, 3, 5, 11, 41, 73 ],
        [ 2, 3, 5, 11, 43, 47 ],
        [ 2, 3, 5, 11, 43, 53 ],
        [ 2, 3, 5, 11, 43, 59 ],
        [ 2, 3, 5, 11, 43, 61 ],
        [ 2, 3, 5, 11, 43, 67 ],
        [ 2, 3, 5, 11, 47, 53 ],
        [ 2, 3, 5, 11, 47, 59 ],
        [ 2, 3, 5, 11, 47, 61 ],
        [ 2, 3, 5, 11, 239 ],
        [ 2, 3, 5, 11, 241 ],
        [ 2, 3, 5, 11, 251 ],
        [ 2, 3, 5, 11, 257 ],
        [ 2, 3, 5, 11, 263 ],
        [ 2, 3, 5, 11, 269 ],
        [ 2, 3, 5, 11, 271 ],
        [ 2, 3, 5, 11, 277 ],
        [ 2, 3, 5, 11, 281 ],
        [ 2, 3, 5, 11, 283 ],
        [ 2, 3, 5, 11, 293 ],
        [ 2, 3, 5, 11, 307 ],
        [ 2, 3, 5, 11, 311 ],
        [ 2, 3, 5, 11, 313 ],
        [ 2, 3, 5, 11, 317 ],
        [ 2, 3, 5, 11, 331 ],
        [ 2, 3, 5, 11, 337 ],
        [ 2, 3, 5, 11, 347 ],
        [ 2, 3, 5, 11, 349 ],
        [ 2, 3, 5, 11, 353 ],
        [ 2, 3, 5, 11, 359 ],
        [ 2, 3, 5, 11, 367 ],
        [ 2, 3, 5, 11, 373 ],
        [ 2, 3, 5, 11, 379 ],
        [ 2, 3, 5, 11, 383 ],
        [ 2, 3, 5, 11, 389 ],
        [ 2, 3, 5, 11, 397 ],
        [ 2, 3, 5, 11, 401 ],
        [ 2, 3, 5, 11, 409 ],
        [ 2, 3, 5, 11, 419 ],
        [ 2, 3, 5, 11, 421 ],
        [ 2, 3, 5, 11, 431 ],
        [ 2, 3, 5, 11, 433 ],
        [ 2, 3, 5, 11, 439 ],
        [ 2, 3, 5, 11, 443 ],
        [ 2, 3, 5, 11, 449 ],
        [ 2, 3, 5, 11, 457 ],
        [ 2, 3, 5, 11, 461 ],
        [ 2, 3, 5, 11, 463 ],
        [ 2, 3, 5, 11, 467 ],
        [ 2, 3, 5, 11, 479 ],
        [ 2, 3, 5, 11, 487 ],
        [ 2, 3, 5, 11, 491 ],
        [ 2, 3, 5, 11, 499 ],
        [ 2, 3, 5, 11, 503 ],
        [ 2, 3, 5, 11, 509 ],
        [ 2, 3, 5, 11, 521 ],
        [ 2, 3, 5, 11, 523 ],
        [ 2, 3, 5, 11, 541 ],
        [ 2, 3, 5, 11, 547 ],
        [ 2, 3, 5, 11, 557 ],
        [ 2, 3, 5, 11, 563 ],
        [ 2, 3, 5, 11, 569 ],
        [ 2, 3, 5, 11, 571 ],
        [ 2, 3, 5, 11, 577 ],
        [ 2, 3, 5, 11, 587 ],
        [ 2, 3, 5, 11, 593 ],
        [ 2, 3, 5, 11, 599 ],
        [ 2, 3, 5, 11, 601 ],
        [ 2, 3, 5, 11, 607 ],
        [ 2, 3, 5, 11, 613 ],
        [ 2, 3, 5, 11, 617 ],
        [ 2, 3, 5, 11, 619 ],
        [ 2, 3, 5, 11, 631 ],
        [ 2, 3, 5, 11, 641 ],
        [ 2, 3, 5, 11, 643 ],
        [ 2, 3, 5, 11, 647 ],
        [ 2, 3, 5, 11, 653 ],
        [ 2, 3, 5, 11, 659 ],
        [ 2, 3, 5, 11, 661 ],
        [ 2, 3, 5, 11, 673 ],
        [ 2, 3, 5, 11, 677 ],
        [ 2, 3, 5, 11, 683 ],
        [ 2, 3, 5, 11, 691 ],
        [ 2, 3, 5, 11, 701 ],
        [ 2, 3, 5, 11, 709 ],
        [ 2, 3, 5, 11, 719 ],
        [ 2, 3, 5, 11, 727 ],
        [ 2, 3, 5, 11, 733 ],
        [ 2, 3, 5, 11, 739 ],
        [ 2, 3, 5, 11, 743 ],
        [ 2, 3, 5, 11, 751 ],
        [ 2, 3, 5, 11, 757 ],
        [ 2, 3, 5, 11, 761 ],
        [ 2, 3, 5, 11, 769 ],
        [ 2, 3, 5, 11, 773 ],
        [ 2, 3, 5, 11, 787 ],
        [ 2, 3, 5, 11, 797 ],
        [ 2, 3, 5, 11, 809 ],
        [ 2, 3, 5, 11, 811 ],
        [ 2, 3, 5, 11, 821 ],
        [ 2, 3, 5, 11, 823 ],
        [ 2, 3, 5, 11, 827 ],
        [ 2, 3, 5, 11, 829 ],
        [ 2, 3, 5, 11, 839 ],
        [ 2, 3, 5, 11, 853 ],
        [ 2, 3, 5, 11, 857 ],
        [ 2, 3, 5, 11, 859 ],
        [ 2, 3, 5, 11, 863 ],
        [ 2, 3, 5, 11, 877 ],
        [ 2, 3, 5, 11, 881 ],
        [ 2, 3, 5, 11, 883 ],
        [ 2, 3, 5, 11, 887 ],
        [ 2, 3, 5, 11, 907 ],
        [ 2, 3, 5, 11, 911 ],
        [ 2, 3, 5, 11, 919 ],
        [ 2, 3, 5, 11, 929 ],
        [ 2, 3, 5, 11, 937 ],
        [ 2, 3, 5, 11, 941 ],
        [ 2, 3, 5, 11, 947 ],
        [ 2, 3, 5, 11, 953 ],
        [ 2, 3, 5, 11, 967 ],
        [ 2, 3, 5, 11, 971 ],
        [ 2, 3, 5, 11, 977 ],
        [ 2, 3, 5, 11, 983 ],
        [ 2, 3, 5, 11, 991 ],
        [ 2, 3, 5, 11, 997 ],
        [ 2, 3, 5, 11, 1009 ],
        [ 2, 3, 5, 11, 1013 ],
        [ 2, 3, 5, 11, 1019 ],
        [ 2, 3, 5, 11, 1021 ],
        [ 2, 3, 5, 11, 1031 ],
        [ 2, 3, 5, 11, 1033 ],
        [ 2, 3, 5, 11, 1039 ],
        [ 2, 3, 5, 11, 1049 ],
        [ 2, 3, 5, 11, 1051 ],
        [ 2, 3, 5, 11, 1061 ],
        [ 2, 3, 5, 11, 1063 ],
        [ 2, 3, 5, 11, 1069 ],
        [ 2, 3, 5, 11, 1087 ],
        [ 2, 3, 5, 11, 1091 ],
        [ 2, 3, 5, 11, 1093 ],
        [ 2, 3, 5, 11, 1097 ],
        [ 2, 3, 5, 11, 1103 ],
        [ 2, 3, 5, 11, 1109 ],
        [ 2, 3, 5, 11, 1117 ],
        [ 2, 3, 5, 11, 1123 ],
        [ 2, 3, 5, 11, 1129 ],
        [ 2, 3, 5, 11, 1151 ],
        [ 2, 3, 5, 11, 1153 ],
        [ 2, 3, 5, 11, 1163 ],
        [ 2, 3, 5, 11, 1171 ],
        [ 2, 3, 5, 11, 1181 ],
        [ 2, 3, 5, 11, 1187 ],
        [ 2, 3, 5, 11, 1193 ],
        [ 2, 3, 5, 11, 1201 ],
        [ 2, 3, 5, 11, 1213 ],
        [ 2, 3, 5, 11, 1217 ],
        [ 2, 3, 5, 11, 1223 ],
        [ 2, 3, 5, 11, 1229 ],
        [ 2, 3, 5, 11, 1231 ],
        [ 2, 3, 5, 11, 1237 ],
        [ 2, 3, 5, 11, 1249 ],
        [ 2, 3, 5, 11, 1259 ],
        [ 2, 3, 5, 11, 1277 ],
        [ 2, 3, 5, 11, 1279 ],
        [ 2, 3, 5, 11, 1283 ],
        [ 2, 3, 5, 11, 1289 ],
        [ 2, 3, 5, 11, 1291 ],
        [ 2, 3, 5, 11, 1297 ],
        [ 2, 3, 5, 11, 1301 ],
        [ 2, 3, 5, 11, 1303 ],
        [ 2, 3, 5, 11, 1307 ],
        [ 2, 3, 5, 11, 1319 ],
        [ 2, 3, 5, 11, 1321 ],
        [ 2, 3, 5, 11, 1327 ],
        [ 2, 3, 5, 11, 1361 ],
        [ 2, 3, 5, 11, 1367 ],
        [ 2, 3, 5, 11, 1373 ],
        [ 2, 3, 5, 11, 1381 ],
        [ 2, 3, 5, 11, 1399 ],
        [ 2, 3, 5, 11, 1409 ],
        [ 2, 3, 5, 11, 1423 ],
        [ 2, 3, 5, 11, 1427 ],
        [ 2, 3, 5, 11, 1429 ],
        [ 2, 3, 5, 11, 1433 ],
        [ 2, 3, 5, 11, 1439 ],
        [ 2, 3, 5, 11, 1447 ],
        [ 2, 3, 5, 11, 1451 ],
        [ 2, 3, 5, 11, 1453 ],
        [ 2, 3, 5, 11, 1459 ],
        [ 2, 3, 5, 11, 1471 ],
        [ 2, 3, 5, 11, 1481 ],
        [ 2, 3, 5, 11, 1483 ],
        [ 2, 3, 5, 11, 1487 ],
        [ 2, 3, 5, 11, 1489 ],
        [ 2, 3, 5, 11, 1493 ],
        [ 2, 3, 5, 11, 1499 ],
        [ 2, 3, 5, 11, 1511 ],
        [ 2, 3, 5, 11, 1523 ],
        [ 2, 3, 5, 11, 1531 ],
        [ 2, 3, 5, 11, 1543 ],
        [ 2, 3, 5, 11, 1549 ],
        [ 2, 3, 5, 11, 1553 ],
        [ 2, 3, 5, 11, 1559 ],
        [ 2, 3, 5, 11, 1567 ],
        [ 2, 3, 5, 11, 1571 ],
        [ 2, 3, 5, 11, 1579 ],
        [ 2, 3, 5, 11, 1583 ],
        [ 2, 3, 5, 11, 1597 ],
        [ 2, 3, 5, 11, 1601 ],
        [ 2, 3, 5, 11, 1607 ],
        [ 2, 3, 5, 11, 1609 ],
        [ 2, 3, 5, 11, 1613 ],
        [ 2, 3, 5, 11, 1619 ],
        [ 2, 3, 5, 11, 1621 ],
        [ 2, 3, 5, 11, 1627 ],
        [ 2, 3, 5, 11, 1637 ],
        [ 2, 3, 5, 11, 1657 ],
        [ 2, 3, 5, 11, 1663 ],
        [ 2, 3, 5, 11, 1667 ],
        [ 2, 3, 5, 11, 1669 ],
        [ 2, 3, 5, 11, 1693 ],
        [ 2, 3, 5, 11, 1697 ],
        [ 2, 3, 5, 11, 1699 ],
        [ 2, 3, 5, 11, 1709 ],
        [ 2, 3, 5, 11, 1721 ],
        [ 2, 3, 5, 11, 1723 ],
        [ 2, 3, 5, 11, 1733 ],
        [ 2, 3, 5, 11, 1741 ],
        [ 2, 3, 5, 11, 1747 ],
        [ 2, 3, 5, 11, 1753 ],
        [ 2, 3, 5, 11, 1759 ],
        [ 2, 3, 5, 11, 1777 ],
        [ 2, 3, 5, 11, 1783 ],
        [ 2, 3, 5, 11, 1787 ],
        [ 2, 3, 5, 11, 1789 ],
        [ 2, 3, 5, 11, 1801 ],
        [ 2, 3, 5, 11, 1811 ],
        [ 2, 3, 5, 11, 1823 ],
        [ 2, 3, 5, 11, 1831 ],
        [ 2, 3, 5, 11, 1847 ],
        [ 2, 3, 5, 11, 1861 ],
        [ 2, 3, 5, 11, 1867 ],
        [ 2, 3, 5, 11, 1871 ],
        [ 2, 3, 5, 11, 1873 ],
        [ 2, 3, 5, 11, 1877 ],
        [ 2, 3, 5, 11, 1879 ],
        [ 2, 3, 5, 11, 1889 ],
        [ 2, 3, 5, 11, 1901 ],
        [ 2, 3, 5, 11, 1907 ],
        [ 2, 3, 5, 11, 1913 ],
        [ 2, 3, 5, 11, 1931 ],
        [ 2, 3, 5, 11, 1933 ],
        [ 2, 3, 5, 11, 1949 ],
        [ 2, 3, 5, 11, 1951 ],
        [ 2, 3, 5, 11, 1973 ],
        [ 2, 3, 5, 11, 1979 ],
        [ 2, 3, 5, 11, 1987 ],
        [ 2, 3, 5, 11, 1993 ],
        [ 2, 3, 5, 11, 1997 ],
        [ 2, 3, 5, 11, 1999 ],
        [ 2, 3, 5, 11, 2003 ],
        [ 2, 3, 5, 11, 2011 ],
        [ 2, 3, 5, 11, 2017 ],
        [ 2, 3, 5, 11, 2027 ],
        [ 2, 3, 5, 11, 2029 ],
        [ 2, 3, 5, 11, 2039 ],
        [ 2, 3, 5, 11, 2053 ],
        [ 2, 3, 5, 11, 2063 ],
        [ 2, 3, 5, 11, 2069 ],
        [ 2, 3, 5, 11, 2081 ],
        [ 2, 3, 5, 11, 2083 ],
        [ 2, 3, 5, 11, 2087 ],
        [ 2, 3, 5, 11, 2089 ],
        [ 2, 3, 5, 11, 2099 ],
        [ 2, 3, 5, 11, 2111 ],
        [ 2, 3, 5, 11, 2113 ],
        [ 2, 3, 5, 11, 2129 ],
        [ 2, 3, 5, 11, 2131 ],
        [ 2, 3, 5, 11, 2137 ],
        [ 2, 3, 5, 11, 2141 ],
        [ 2, 3, 5, 11, 2143 ],
        [ 2, 3, 5, 11, 2153 ],
        [ 2, 3, 5, 11, 2161 ],
        [ 2, 3, 5, 11, 2179 ],
        [ 2, 3, 5, 11, 2203 ],
        [ 2, 3, 5, 11, 2207 ],
        [ 2, 3, 5, 11, 2213 ],
        [ 2, 3, 5, 11, 2221 ],
        [ 2, 3, 5, 11, 2237 ],
        [ 2, 3, 5, 11, 2239 ],
        [ 2, 3, 5, 11, 2243 ],
        [ 2, 3, 5, 11, 2251 ],
        [ 2, 3, 5, 11, 2267 ],
        [ 2, 3, 5, 11, 2269 ],
        [ 2, 3, 5, 11, 2273 ],
        [ 2, 3, 5, 11, 2281 ],
        [ 2, 3, 5, 11, 2287 ],
        [ 2, 3, 5, 11, 2293 ],
        [ 2, 3, 5, 11, 2297 ],
        [ 2, 3, 5, 11, 2309 ],
        [ 2, 3, 5, 11, 2311 ],
        [ 2, 3, 5, 11, 2333 ],
        [ 2, 3, 5, 11, 2339 ],
        [ 2, 3, 5, 11, 2341 ],
        [ 2, 3, 5, 11, 2347 ],
        [ 2, 3, 5, 11, 2351 ],
        [ 2, 3, 5, 11, 2357 ],
        [ 2, 3, 5, 11, 2371 ],
        [ 2, 3, 5, 11, 2377 ],
        [ 2, 3, 5, 11, 2381 ],
        [ 2, 3, 5, 11, 2383 ],
        [ 2, 3, 5, 11, 2389 ],
        [ 2, 3, 5, 11, 2393 ],
        [ 2, 3, 5, 11, 2399 ],
        [ 2, 3, 5, 11, 2411 ],
        [ 2, 3, 5, 11, 2417 ],
        [ 2, 3, 5, 11, 2423 ],
        [ 2, 3, 5, 11, 2437 ],
        [ 2, 3, 5, 11, 2441 ],
        [ 2, 3, 5, 11, 2447 ],
        [ 2, 3, 5, 11, 2459 ],
        [ 2, 3, 5, 11, 2467 ],
        [ 2, 3, 5, 11, 2473 ],
        [ 2, 3, 5, 11, 2477 ],
        [ 2, 3, 5, 11, 2503 ],
        [ 2, 3, 5, 11, 2521 ],
        [ 2, 3, 5, 11, 2531 ],
        [ 2, 3, 5, 11, 2539 ],
        [ 2, 3, 5, 11, 2543 ],
        [ 2, 3, 5, 11, 2549 ],
        [ 2, 3, 5, 11, 2551 ],
        [ 2, 3, 5, 11, 2557 ],
        [ 2, 3, 5, 11, 2579 ],
        [ 2, 3, 5, 11, 2591 ],
        [ 2, 3, 5, 11, 2593 ],
        [ 2, 3, 5, 11, 2609 ],
        [ 2, 3, 5, 11, 2617 ],
        [ 2, 3, 5, 11, 2621 ],
        [ 2, 3, 5, 11, 2633 ],
        [ 2, 3, 5, 11, 2647 ],
        [ 2, 3, 5, 11, 2657 ],
        [ 2, 3, 5, 11, 2659 ],
        [ 2, 3, 5, 11, 2663 ],
        [ 2, 3, 5, 11, 2671 ],
        [ 2, 3, 5, 11, 2677 ],
        [ 2, 3, 5, 11, 2683 ],
        [ 2, 3, 5, 11, 2687 ],
        [ 2, 3, 5, 11, 2689 ],
        [ 2, 3, 5, 11, 2693 ],
        [ 2, 3, 5, 11, 2699 ],
        [ 2, 3, 5, 11, 2707 ],
        [ 2, 3, 5, 11, 2711 ],
        [ 2, 3, 5, 11, 2713 ],
        [ 2, 3, 5, 11, 2719 ],
        [ 2, 3, 5, 11, 2729 ],
        [ 2, 3, 5, 11, 2731 ],
        [ 2, 3, 5, 11, 2741 ],
        [ 2, 3, 5, 11, 2749 ],
        [ 2, 3, 5, 11, 2753 ],
        [ 2, 3, 5, 11, 2767 ],
        [ 2, 3, 5, 11, 2777 ],
        [ 2, 3, 5, 11, 2789 ],
        [ 2, 3, 5, 11, 2791 ],
        [ 2, 3, 5, 11, 2797 ],
        [ 2, 3, 5, 11, 2801 ],
        [ 2, 3, 5, 11, 2803 ],
        [ 2, 3, 5, 11, 2819 ],
        [ 2, 3, 5, 11, 2833 ],
        [ 2, 3, 5, 11, 2837 ],
        [ 2, 3, 5, 11, 2843 ],
        [ 2, 3, 5, 11, 2851 ],
        [ 2, 3, 5, 11, 2857 ],
        [ 2, 3, 5, 11, 2861 ],
        [ 2, 3, 5, 11, 2879 ],
        [ 2, 3, 5, 11, 2887 ],
        [ 2, 3, 5, 11, 2897 ],
        [ 2, 3, 5, 11, 2903 ],
        [ 2, 3, 5, 11, 2909 ],
        [ 2, 3, 5, 11, 2917 ],
        [ 2, 3, 5, 11, 2927 ],
        [ 2, 3, 5, 11, 2939 ],
        [ 2, 3, 5, 11, 2953 ],
        [ 2, 3, 5, 11, 2957 ],
        [ 2, 3, 5, 11, 2963 ],
        [ 2, 3, 5, 11, 2969 ],
        [ 2, 3, 5, 11, 2971 ],
        [ 2, 3, 5, 11, 2999 ],
        [ 2, 3, 5, 11, 3001 ],
        [ 2, 3, 5, 11, 3011 ],
        [ 2, 3, 5, 11, 3019 ],
        [ 2, 3, 5, 11, 3023 ]
    ]
    
*/


procedure RecursiveSets(~S, ~nSets ,i ,n, m)
    if i gt n then
        prod:= &*S;     // computes the product of the elements of S
        bound:= Floor(m/prod);  // generates the upper bound on the possible primes which may be added to S; ie. such that if P <= bound, then [prod_{i \in S} s]*P <= m 
        a:= NextPrime(S[#S-1]);    // generates the next largest prime after the (#S-1)th prime of S
        
        if a le bound then
            b:= PreviousPrime(bound + 1);       // generates the largest prime which is smaller than bound; this is the largest potential prime P which may be added to S
                                                    // ie. such that if P <= bound, then [prod_{i \in S} s]*P <= m 
            Int:= PrimesInInterval(a, b);       // generates all possible primes in the interval (a,b)
            if IsEmpty(Int) eq true then
                Append(~nSets, S);      // appends S to nSets only if Int is empty; ie. if there are no primes which may be added to S which lie between S[#S-1] and the bound
                                            // if Int is non-empty, then more primes may be added to S with the required property that [prod_{i \in S} s] <= m
                                            // since this algorithm computes the sets S from largest to smallest, if Int is non-empty, then S is a subset of another set of nSets, hence we may disclude it 
            end if;
        else
            Append(~nSets, S);  // if a > bound, there are no primes which may be added to S (the primes P with P <= bound are already in S)
        end if;

    else
        prod:= &*([ S[j] : j in [1..(i-1)] ]);  // computes the product of the first i-1 primes of the set of primes S
        bound:= Floor(m/prod);  // generates the upper bound on the possible ith prime of S
        a:= NextPrime(S[i-1]);  // generates the next largest prime of S[i-1]; this is the smallest potential ith prime 
        
        if a le bound then
            b:= PreviousPrime(bound + 1);       // generates the largest prime which is smaller than bound; this is the largest potential ith prime which may be added to S
            Int:= PrimesInInterval(a, b);       // generates all possibilities for the ith prime in the interval [a,b];
            for p in Int do
                tS:= ([ S[j] : j in [1..(i-1)] ]);      // generates a set of primes tS; these are the first (i-1) primes of S
                Append(~tS, p);         
                
                RecursiveSets(~tS, ~nSets, i+1, n, m);  // re-enters the procedure with (i -> i+1) until i > n
            end for;
        else
            RecursiveSets(~S, ~nSets, n+1, n, m);       // re-enters the procedure with (i -> n+1) so that i > n to append S to nSets and exit the overall procedure
                                                            // ie a > bound, so there are no primes to be added to S
        end if;
    end if;
end procedure;